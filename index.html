<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZTNA SOC - Static Defense Version</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@500;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <link rel="stylesheet" href="style.css?v=5.1">
</head>

<body>
    <div class="soc-layout">
        <!-- SIDEBAR -->
        <aside class="sidebar">
            <div class="brand">
                <ion-icon name="shield-checkmark"></ion-icon>
                <span>TRASHURE SOC</span>
            </div>

            <nav class="nav-group">
                <div class="nav-link active" onclick="switchView('overview')">
                    <ion-icon name="grid-outline"></ion-icon>
                    <span>OVERVIEW</span>
                </div>
            </nav>

            <div class="dept-section">
                <span class="stat-label" style="display: block; margin-bottom: 10px;">ENTERPRISE UNITS & RISK
                    PROFILE</span>
                <div id="deptList">
                    <button class="dept-btn" onclick="selectDept('LOGISTICS', '10.62.30.120')">LOGISTICS UNIT (LOW
                        RISK)</button>
                    <button class="dept-btn" onclick="selectDept('PRODUCTION', '10.62.30.110')">PRODUCTION LINE (MED
                        RISK)</button>
                    <button class="dept-btn" onclick="selectDept('R&D', '10.62.30.130')">R&D CLOUD (HIGH RISK)</button>
                    <button class="dept-btn" onclick="selectDept('HR', '10.62.30.104')">HR DEPT (TRUSTED)</button>
                    <button class="dept-btn" onclick="selectDept('WAREHOUSE', '10.62.30.140')">WAREHOUSE (LOW)</button>
                    <button class="dept-btn" onclick="selectDept('QUALITY', '10.62.30.150')">QUALITY CTRL (LOW)</button>
                    <button class="dept-btn" onclick="selectDept('ENGINEERING', '10.62.30.160')">ENGINEERING
                        (MED)</button>
                </div>
            </div>

            <div style="padding: 12px; border-top: 1px solid var(--border);">
                <span id="activeDeptLabel"
                    style="font-size: 0.55rem; color: var(--accent-primary); display: block; margin-bottom: 5px;">SELECT
                    UNIT ABOVE</span>
                <div style="display: flex; gap: 5px;">
                    <button class="mfa-btn"
                        style="background: var(--accent-success); font-size: 0.6rem; padding: 6px; flex: 1"
                        onclick="tryAccess('READ')">READ</button>
                    <button class="mfa-btn"
                        style="background: var(--accent-danger); font-size: 0.6rem; padding: 6px; flex: 1"
                        onclick="tryAccess('WRITE')">WRITE</button>
                </div>
                <div style="display: flex; gap: 5px; margin-top: 4px;">
                    <button class="mfa-btn"
                        style="background: var(--accent-warning); color: #000; font-size: 0.5rem; padding: 4px; flex: 1; font-weight: bold;"
                        onclick="trySystemSettings()">SYSTEM CONSOLE (GPO TEST)</button>
                </div>
            </div>

            <!-- PHYSICAL INFRASTRUCTURE MONITOR (ABSTRACT ALIGNMENT) -->
            <div style="padding: 10px; border-top: 1px solid var(--border); background: rgba(255,255,255,0.02);">
                <span class="stat-label" style="color: var(--text-muted); font-size: 0.45rem;">PHYSICAL LAYER MONITOR
                    (RJ45/RJ11)</span>
                <div style="display: flex; align-items: center; gap: 8px; margin-top: 4px;">
                    <div class="status-dot"
                        style="background: var(--accent-success); width: 6px; height: 6px; box-shadow: 0 0 5px var(--accent-success);">
                    </div>
                    <span style="font-size: 0.5rem; color: var(--accent-success); font-family: var(--font-data);">LINE
                        READY [STABLE]</span>
                </div>
            </div>

            <!-- RAW DATA MONITOR -->
            <div style="padding: 10px; flex: 1; display: flex; flex-direction: column; min-height: 0;">
                <span class="stat-label"
                    style="color: var(--accent-primary); font-weight: bold; margin-bottom: 5px; font-size: 0.5rem;">RAW
                    TELEMETRY MONITOR</span>
                <pre id="rawMonitor"
                    style="flex: 1; background: #000; color: #4ade80; font-family: var(--font-data); font-size: 0.45rem; padding: 5px; border-radius: 4px; overflow: hidden; border: 1px solid var(--border);">WAITING FOR DATA...</pre>
            </div>
        </aside>

        <!-- MAIN VIEW -->
        <main class="main-view">
            <header class="top-bar">
                <div style="display: flex; align-items: center; gap: 15px;">
                    <span style="font-size: 0.7rem; color: var(--text-muted);">trashure.local</span>
                    <div class="status-badge" style="background: rgba(34, 197, 94, 0.1); color: var(--accent-success);">
                        <div class="status-dot pulse-primary"></div>
                        <span style="font-size: 0.6rem;">CONTINUOUS VERIFICATION ACTIVE</span>
                    </div>
                </div>
                <div style="display: flex; gap: 15px; font-size: 0.7rem; font-family: var(--font-data);">
                    <div id="socClock">00:00:00</div>
                    <div style="color: var(--accent-primary)">GATEWAY: 10.62.8.200 (LAYER-1)</div>
                    <div style="color: var(--accent-success)">PROXMOX-NODE: STABLE</div>
                </div>
            </header>

            <div class="dashboard-grid">
                <!-- STATS -->
                <div class="stat-card">
                    <span class="stat-label">Total Requests</span>
                    <h2 class="stat-value" id="reqTotal">0</h2>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Blocked Threats</span>
                    <h2 class="stat-value" id="threatTotal">0</h2>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Avg Risk Score</span>
                    <h2 class="stat-value" id="riskAvg">0.0%</h2>
                </div>
                <div class="stat-card">
                    <span class="stat-label">Proxmox CPU</span>
                    <div class="progress-bg" style="margin-top: 10px;">
                        <div id="hostCpu" class="progress-fill" style="width: 12%; background: var(--accent-success)">
                        </div>
                    </div>
                    <span style="font-size: 0.5rem; color: var(--text-muted); margin-top: 4px; display: block;">Intel
                        i7-6600U (Virtual Cluster)</span>
                </div>

                <!-- GRAPHS -->
                <div class="widget-box" style="grid-column: span 2;">
                    <span class="widget-title">ACCESS TRAFFIC TRENDS (REAL-TIME)</span>
                    <div style="flex: 1; min-height: 0;"><canvas id="trafficChart"></canvas></div>
                </div>

                <div class="widget-box" style="grid-column: span 2;">
                    <span class="widget-title">THREAT GEOLOCATION</span>
                    <div class="world-map-placeholder" id="worldMap"></div>
                </div>

                <!-- LOGS & RBA -->
                <div class="widget-box" style="grid-column: span 3;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span class="widget-title">LIVE ACCESS AUDIT STREAM (RISK-AWARE)</span>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <span
                                style="font-size: 0.45rem; color: var(--accent-success); border-bottom: 1px dashed; cursor: pointer;"
                                onclick="showPolicyModal()">VIEW ZTNA POLICY MATRIX</span>
                            <ion-icon name="information-circle-outline"
                                style="color: var(--accent-primary); font-size: 0.8rem;"></ion-icon>
                        </div>
                    </div>
                    <div id="auditStream" class="log-stream"></div>
                </div>

                <div class="widget-box" style="grid-column: span 1;">
                    <span class="widget-title">RBA FACTOR BREAKDOWN</span>
                    <div class="rba-factors">
                        <div class="factor-item" style="margin-bottom: 8px;">
                            <div style="display: flex; justify-content: space-between; align-items: baseline;">
                                <label style="font-size: 0.55rem; color: var(--text-primary); font-weight: bold;">Geo
                                    Context</label>
                                <span id="valGeo"
                                    style="font-size: 0.5rem; color: var(--accent-primary); font-family: var(--font-data);">0%</span>
                            </div>
                            <span style="font-size: 0.45rem; color: var(--text-muted); line-height: 1.1;">Analisis
                                anomali lokasi login & reputasi IP</span>
                            <div class="progress-bg">
                                <div id="barGeo" class="progress-fill" style="width: 5%"></div>
                            </div>
                        </div>
                        <div class="factor-item" style="margin-bottom: 8px;">
                            <div style="display: flex; justify-content: space-between; align-items: baseline;">
                                <label
                                    style="font-size: 0.55rem; color: var(--text-primary); font-weight: bold;">Velocity
                                    Analysis</label>
                                <span id="valVelocity"
                                    style="font-size: 0.5rem; color: var(--accent-primary); font-family: var(--font-data);">0%</span>
                            </div>
                            <span style="font-size: 0.45rem; color: var(--text-muted); line-height: 1.1;">Analisis
                                frekuensi & pola akses real-time</span>
                            <div class="progress-bg">
                                <div id="barVelocity" class="progress-fill" style="width: 2%"></div>
                            </div>
                        </div>
                        <div class="factor-item" style="margin-bottom: 8px;">
                            <div style="display: flex; justify-content: space-between; align-items: baseline;">
                                <label
                                    style="font-size: 0.55rem; color: var(--text-primary); font-weight: bold;">Identity
                                    Integrity</label>
                                <span id="valIntegrity"
                                    style="font-size: 0.5rem; color: var(--accent-success); font-family: var(--font-data);">100%</span>
                            </div>
                            <span style="font-size: 0.45rem; color: var(--text-muted); line-height: 1.1;">Verifikasi
                                Device Trust & AD GPO Policy</span>
                            <div class="progress-bg">
                                <div id="barIntegrity" class="progress-fill"
                                    style="width: 98%; background: var(--accent-success)"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- ZTNA POLICY MATRIX MODAL -->
    <div id="policyModal" class="mfa-overlay hidden">
        <div class="mfa-card"
            style="width: 400px; max-width: 90vw; background: #0f172a; border: 1px solid var(--accent-primary);">
            <h2 class="mfa-title"
                style="color: var(--accent-primary); border-bottom: 1px solid var(--border); padding-bottom: 10px;">üõ°Ô∏è
                ZTNA DECISION MATRIX</h2>
            <div style="font-size: 0.65rem; line-height: 1.6; text-align: left; padding: 10px 0;">
                <p><strong>Step 1: Identity Discovery</strong> (Active Directory AD DS)</p>
                <p style="color: var(--text-muted); margin-bottom: 8px;">‚Ä¢ Check Group Policy (GPO) per department.</p>

                <p><strong>Step 2: Risk-Based Analysis</strong> (RBA Factors)</p>
                <p style="color: var(--text-muted); margin-bottom: 8px;">‚Ä¢ Score Context (Geo/Velocity) & Integrity.</p>

                <p><strong>Step 3: Adaptive Enforcement</strong> (Response)</p>
                <p style="color: var(--accent-success);">‚Ä¢ RISK < 35%: <strong>GRANT ACCESS [ZTNA]</strong></p>
                <p style="color: var(--accent-warning);">‚Ä¢ RISK 35-70%: <strong>TRIGGER ADAPTIVE MFA</strong></p>
                <p style="color: var(--accent-danger);">‚Ä¢ RISK > 70%: <strong>EXPLICIT BLOCK [ADM_POLICY]</strong></p>
            </div>
            <button class="mfa-btn" onclick="hidePolicyModal()"
                style="background: var(--accent-primary); margin-top: 15px;">CLOSE ARCHITECTURE VIEW</button>
        </div>
    </div>

    <!-- SMARTPHONE AUTHENTICATOR SIMULATOR -->
    <div id="phoneSim" class="phone-container">
        <div class="phone-frame">
            <div class="phone-screen">
                <div class="phone-header">
                    <span id="phoneTime">00:00</span>
                    <div class="phone-icons">
                        <ion-icon name="wifi"></ion-icon>
                        <ion-icon name="battery-full"></ion-icon>
                    </div>
                </div>

                <div id="phoneIdle" class="phone-content">
                    <div class="app-icon">üõ°Ô∏è</div>
                    <p style="font-size: 0.6rem; margin-top: 10px;">SULTAN AUTH</p>
                    <p style="font-size: 0.5rem; color: #94a3b8;">Listening for push...</p>
                </div>

                <div id="phoneAuth" class="phone-content hidden">
                    <ion-icon name="finger-print-outline" class="pulse-primary"
                        style="font-size: 2.5rem; margin-bottom: 15px; color: var(--accent-primary);"></ion-icon>
                    <h4 style="font-size: 0.75rem;">MFA REQUEST</h4>
                    <p id="authMsg" style="font-size: 0.55rem; color: #94a3b8; margin: 10px 0;">GPO Override: Write
                        Access for PRODUCTION unit.</p>
                    <div style="display: flex; gap: 5px; width: 100%; padding: 0 10px;">
                        <button class="mfa-btn"
                            style="flex: 1; padding: 8px; font-size: 0.6rem; background: var(--accent-success)"
                            onclick="phoneAction('APPROVE')">APPROVE</button>
                        <button class="mfa-btn"
                            style="flex: 1; padding: 8px; font-size: 0.6rem; background: var(--accent-danger)"
                            onclick="phoneAction('DENY')">DENY</button>
                    </div>
                </div>

                <div id="phoneSuccess" class="phone-content hidden">
                    <ion-icon name="checkmark-circle-outline"
                        style="font-size: 3rem; color: var(--accent-success)"></ion-icon>
                    <p style="font-size: 0.7rem; margin-top: 10px;">AUTHORIZED</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Static Engine (No Backend Needed) -->
    <script src="engine.js?v=5.1"></script>
</body>

</html>